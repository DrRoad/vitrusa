#simplify variables and calculate SOC density for each sample
W_ped <- Wd %>% select (-layer) %>%
filter(Prop %in% c('CALC_SOC', 'Tot_N', 'Tot_C', 'CF_labvol', 'BulkDensity')) %>%
spread(Prop, Value) %>%
mutate(SOC = ifelse(CALC_SOC<0, 0, CALC_SOC),
bd = BulkDensity, TN=Tot_N,
TOP = hor_top, BOT = hor_bot,
CF = ifelse(CF_labvol==0,0,CF_labvol/100)) %>%
mutate(thick = BOT - TOP, SOCden = SOC*bd*(1 - CF), TNden = TN*bd*(1 - CF)) %>%
mutate(d5  = ifelse(BOT <=5, thick, ifelse(TOP<5, 5-TOP,0 )),
d30 = ifelse(BOT <=30, thick, ifelse(TOP<30, 30-TOP,0 )),
d50 = ifelse(BOT <=50, thick, ifelse(TOP<50, 50-TOP,0 )),
d100 = ifelse(BOT <=100, thick, ifelse(TOP<100, 100-TOP,0 ))) %>%
#check values for on pedon with NA values
# filter(Date=="2014" & Comp=="GR1" & Pedon =="A" & Soil_abbrev == "O") %>%
#   select(UserPedonID, Date, Comp, Pedon, Veg, Till, MGMT, Soil_abbrev, TOP, BOT, SOC, BD, bd, CF, SOCden, TNden, d5, d30, d50, d100) %>%
select(UserPedonID, Date, Comp, Pedon, Veg, Till, MGMT, Soil_abbrev, SOCden, TNden, d5, d30, d50, d100) %>%
group_by(UserPedonID, Date, Comp, Pedon, Veg, Till, MGMT, Soil_abbrev) %>%
summarise(SOCstock5 = sum(SOCden*d5, na.rm = T),
SOCstock30 = sum(SOCden*d30, na.rm = T),
SOCstock50 = sum(SOCden*d50, na.rm = T),
TNstock5 = sum(TNden*d5, na.rm = T),
TNstock30 = sum(TNden*d30, na.rm = T),
TNstock50 = sum(TNden*d50, na.rm = T)
)
W_ped <- Wd %>%
filter(Prop %in% c('CALC_SOC', 'Tot_N', 'Tot_C', 'CF_labvol', 'BulkDensity')) %>%
spread(Prop, Value) %>%
mutate(SOC = ifelse(CALC_SOC<0, 0, CALC_SOC),
bd = BulkDensity, TN=Tot_N,
TOP = hor_top, BOT = hor_bot,
CF = ifelse(CF_labvol==0,0,CF_labvol/100)) %>%
mutate(thick = BOT - TOP, SOCden = SOC*bd*(1 - CF), TNden = TN*bd*(1 - CF)) %>%
mutate(d5  = ifelse(BOT <=5, thick, ifelse(TOP<5, 5-TOP,0 )),
d30 = ifelse(BOT <=30, thick, ifelse(TOP<30, 30-TOP,0 ))) %>%
#filter to remove replicates
Wd <- wd #past analysis filtered at this stage
Wd <-wd #recreate skipped steps
Properties <- c('WaterSol_P', 'Mehlich3_P', ' Tot_P', 'NewZ_P') #list of properties that will be graphed
ggplot(Wd %>% filter(Prop %in% Properties & hor_top == 0) %>% mutate(Mgmt = factor(MGMT, levels = c('CT-C/S', 'RT-C/S', 'Grass'))), aes(y = Value, x = Soil)) + geom_boxplot(aes(fill = Mgmt), alpha = .5)   +   facet_wrap(~Prop, ncol=5, scales = "free_y") +
theme(legend.position="top",  axis.text.x=element_text(angle=-45, hjust = -.01), strip.text.y=element_text(size=4)) +
ggtitle("Surface Sample") # need to add labeller = nameProp
Wd <-wd #recreate skipped steps
Properties <- c('WaterSol_P', 'Mehlich3_P', ' Tot_P', 'NewZ_P') #list of properties that will be graphed
ggplot(Wd %>% filter(Prop %in% Properties & hor_top == 0) %>% mutate(mgmt = factor(mgmt, levels = c('CT-C/S', 'RT-C/S', 'Grass'))), aes(y = Value, x = Soil)) + geom_boxplot(aes(fill = mgmt), alpha = .5)   +   facet_wrap(~Prop, ncol=5, scales = "free_y") +
theme(legend.position="top",  axis.text.x=element_text(angle=-45, hjust = -.01), strip.text.y=element_text(size=4)) +
ggtitle("Surface Sample") # need to add labeller = nameProp
names(Wd)
factor(Wd$Mgmt)
Properties <- c('WaterSol_P', 'Mehlich3_P', ' Tot_P', 'NewZ_P') #list of properties that will be graphed
ggplot(Wd %>% filter(Prop %in% Properties & hor_top == 0), aes(y = Value, x = Soil)) + geom_boxplot(aes(fill = Comp), alpha = .5)   +   facet_wrap(~Prop, ncol=5, scales = "free_y") +
theme(legend.position="top",  axis.text.x=element_text(angle=-45, hjust = -.01), strip.text.y=element_text(size=4)) +
ggtitle("Surface Sample")
ggplot(Wd %>% filter(Prop %in% Properties & hor_top == 0), aes(y = Value, x = Soil)) + geom_boxplot(aes(fill = Comp), alpha = .5)   +   facet_wrap(~Prop, ncol=5, scales = "free_y") +
theme(legend.position="top",  axis.text.x=element_text(angle=-45, hjust = -.01), strip.text.y=element_text(size=4)) +
ggtitle("Surface Sample")
ggplot(Wd %>% filter(Prop %in% Properties2 & hor_top == 0), aes(y = Value, x = Soil)) + geom_boxplot(aes(fill = Comp), alpha = .5)   +   facet_wrap(~Prop, ncol=3, scales = "free_y") +
theme(legend.position="top",  axis.text.x=element_text(angle=-45, hjust = -.01), strip.text.y=element_text(size=4)) +
ggtitle("Surface Sample") # need to add labeller = nameProp
Properties2 <- c('AggStab', 'Bgluc',  'Pom_C')
ggplot(Wd %>% filter(Prop %in% Properties2 & hor_top == 0), aes(y = Value, x = Soil)) + geom_boxplot(aes(fill = Comp), alpha = .5)   +   facet_wrap(~Prop, ncol=3, scales = "free_y") +
theme(legend.position="top",  axis.text.x=element_text(angle=-45, hjust = -.01), strip.text.y=element_text(size=4)) +
ggtitle("Surface Sample") # need to add labeller = nameProp
ggplot(Wd %>% filter(Prop %in% Properties2 & hor_top == 0), aes(y = Value, x = Soil)) + geom_boxplot(aes(fill = Comp), alpha = .5)   +   facet_wrap(~Prop, ncol=3, scales = "free_y") +
theme(legend.position="top",  axis.text.x=element_text(angle=-45, hjust = -.01), strip.text.y=element_text(size=4)) +
ggtitle("Surface Sample") # need to add labeller = nameProp
Properties3 <- c('Tot_N', 'Pom_N','BulkDensity', 'pH_H20', 'CEC_ph7')
ggplot(Wd %>% filter(Prop %in% Properties3 & hor_top == 0), aes(y = Value, x = Soil)) + geom_boxplot(aes(fill = Comp), alpha = .5)   +   facet_wrap(~Prop, ncol=5, scales = "free_y") +
theme(legend.position="top",  axis.text.x=element_text(angle=-45, hjust = -.01), strip.text.y=element_text(size=4)) +
ggtitle("Surface Sample") # need to add labeller = nameProp
Properties3 <- c('Tot_N', 'Pom_N','BulkDensity', 'pH_H20', 'CEC_ph7')
ggplot(Wd %>% filter(Prop %in% Properties3 & hor_top == 0), aes(y = Value, x = Soil)) + geom_boxplot(aes(fill = Comp), alpha = .5)   +   facet_wrap(~Prop, ncol=5, scales = "free_y") +
theme(legend.position="top",  axis.text.x=element_text(angle=-45, hjust = -.01), strip.text.y=element_text(size=4)) +
ggtitle("Surface Sample") # need to add labeller = nameProp
Properties3 <- c('Tot_N', 'Pom_N','BulkDensity', 'pH_h20', 'CEC_ph7')
ggplot(Wd %>% filter(Prop %in% Properties3 & hor_top == 0), aes(y = Value, x = Soil)) + geom_boxplot(aes(fill = Comp), alpha = .5)   +   facet_wrap(~Prop, ncol=5, scales = "free_y") +
theme(legend.position="top",  axis.text.x=element_text(angle=-45, hjust = -.01), strip.text.y=element_text(size=4)) +
ggtitle("Surface Sample") # need to add labeller = nameProp
table(Wd$Prop)
Properties3 <- c('Tot_N', 'Pom_N','BulkDensity', 'ph_h20', 'CEC_ph7')
ggplot(Wd %>% filter(Prop %in% Properties3 & hor_top == 0), aes(y = Value, x = Soil)) + geom_boxplot(aes(fill = Comp), alpha = .5)   +   facet_wrap(~Prop, ncol=5, scales = "free_y") +
theme(legend.position="top",  axis.text.x=element_text(angle=-45, hjust = -.01), strip.text.y=element_text(size=4)) +
ggtitle("Surface Sample") # need to add labeller = nameProp
lev <- as.factor(Wd$Prop)
i <- "BulkDensity"
ggplot(Wd %>% filter(Prop == i) , aes(y = Value, x = comp)) +
geom_boxplot(aes(fill = Comp), alpha = .5)   +
theme(legend.position="top")   +  ylab(paste(i)) + xlab(" ") +
facet_wrap(~hor_top, ncol=1) +
ggtitle(paste0(i, for all Samples))
print(b)
ggplot(Wd %>% filter(Prop == i) , aes(y = Value, x = comp)) +
geom_boxplot(aes(fill = Comp), alpha = .5)
ggplot(Wd %>% filter(Prop == i) , aes(y = Value, x = Comp)) +
geom_boxplot(aes(fill = Comp), alpha = .5) +
theme(legend.position="top")   +  ylab(paste(i)) + xlab(" ") +
ggtitle(paste0(i, for all Samples))
ggplot(Wd %>% filter(Prop == i) , aes(y = Value, x = Comp)) +
geom_boxplot(aes(fill = Comp), alpha = .5) +
theme(legend.position="top")
ggplot(Wd %>% filter(Prop == i) , aes(y = Value, x = Comp)) +
geom_boxplot(aes(fill = Comp), alpha = .5) +
theme(legend.position="top")
ggplot(Wd%>% filter(Prop == i ), aes(x=Value, y=Mgmt, fill = Comp, height = ..density..)) +
geom_joy(scale = 4, stat = "density", alpha = 0.5)  + xlab(paste(i)) +  ggtitle(paste0(i, " for Leen - A Horizons")) +
scale_y_discrete(expand=c(0.1, 0)) +
scale_x_continuous(expand=c(0.01, 0)) + theme_joy()
library(ggjoy)
ggplot(Wd%>% filter(Prop == i ), aes(x=Value, y=Mgmt, fill = Comp, height = ..density..)) +
geom_joy(scale = 4, stat = "density", alpha = 0.5)  + xlab(paste(i)) +  ggtitle(paste0(i, " for Leen - A Horizons")) +
scale_y_discrete(expand=c(0.1, 0)) +
scale_x_continuous(expand=c(0.01, 0)) + theme_joy()
ggplot(Wd%>% filter(Prop == i ), aes(x=Value, y = Comp, color = hor_top, fill = ..x..)) +
scale_color_viridis()+
geom_joy(alpha = 0.75, fill = "lightgray") +
geom_quasirandom(alpha=0.82, groupOnX=FALSE) +
scale_fill_viridis() + theme_joy()+
theme(plot.caption=element_text(hjust=0,size=9),
axis.title=element_text(size=12),
plot.title=element_text(size=24))+
labs(x= i ,y="Layer Top Depth",caption="@wills_skye", title="JoySwarm Plot")
library(ggjoy)
library(ggbeeswarm)
library(viridis)
ggplot(Wd%>% filter(Prop == i ), aes(x=Value, y=Mgmt, fill = Comp, height = ..density..)) +     geom_joy(scale = 4, stat = "density", alpha = 0.5)  + xlab(paste(i)) +  ggtitle(paste0(i, " for All Horizons")) +
scale_y_discrete(expand=c(0.1, 0)) +
scale_x_continuous(expand=c(0.01, 0)) + theme_joy()
ggplot(Wd%>% filter(Prop == i ), aes(x=Value, y = Comp, color = hor_top, fill = ..x..)) +
scale_color_viridis()+
geom_joy(alpha = 0.75, fill = "lightgray") +
geom_quasirandom(alpha=0.82, groupOnX=FALSE) +
scale_fill_viridis() + theme_joy()+
theme(plot.caption=element_text(hjust=0,size=9),
axis.title=element_text(size=12),
plot.title=element_text(size=24))+
labs(x= i ,y="Layer Top Depth",caption="@wills_skye", title="JoySwarm Plot")
ggplot(Wd%>% filter(Prop == i ), aes(x=Value, y=Mgmt, fill = Comp, height = ..density..)) +     geom_joy(scale = 4, stat = "density", alpha = 0.5)  + xlab(paste(i)) +  ggtitle(paste0(i, " for All Horizons")) +
scale_y_discrete(expand=c(0.1, 0)) +
scale_x_continuous(expand=c(0.01, 0)) + theme_joy() +
scale_fill_gradientn(colours = cet_pal(5, name = "fire"))+
ggplot(Wd%>% filter(Prop == i ), aes(x=Value, y = Comp, color = hor_top, fill = ..x..)) +
scale_color_viridis()+
geom_joy(alpha = 0.75, fill = "lightgray") +
geom_quasirandom(alpha=0.82, groupOnX=FALSE) +
scale_fill_viridis() + theme_joy()+
theme(plot.caption=element_text(hjust=0,size=9),
axis.title=element_text(size=12),
plot.title=element_text(size=24))+
lab
library(cetcolor)
ggplot(Wd%>% filter(Prop == i ), aes(x=Value, y=Mgmt, fill = Comp, height = ..density..)) +     geom_joy(scale = 4, stat = "density", alpha = 0.5)  + xlab(paste(i)) +  ggtitle(paste0(i, " for All Horizons")) +
scale_y_discrete(expand=c(0.1, 0)) +
scale_x_continuous(expand=c(0.01, 0)) + theme_joy() +
scale_fill_gradientn(colours = cet_pal(5, name = "fire"))
ggplot(Wd%>% filter(Prop == i ), aes(x=Value, y=Mgmt, fill = Value, height = ..density..)) +     geom_joy(scale = 4, stat = "density", alpha = 0.5)  + xlab(paste(i)) +  ggtitle(paste0(i, " for All Horizons")) +
scale_y_discrete(expand=c(0.1, 0)) +
scale_x_continuous(expand=c(0.01, 0)) + theme_joy() +
scale_fill_gradientn(colours = cet_pal(5, name = "fire"))
ggplot(Wd%>% filter(Prop == i ), aes(x=Value, y=Mgmt, fill = Value, height = ..density..)) +     geom_joy(scale = 4, stat = "density", alpha = 0.5)  + xlab(paste(i)) +  ggtitle(paste0(i, " for All Horizons")) +
scale_y_discrete(expand=c(0.1, 0)) +
scale_x_continuous(expand=c(0.01, 0)) + theme_joy() +
scale_fill_gradientn(colours = cet_pal(5, name = "fire"))
ggplot(Wd%>% filter(Prop == i ), aes(x=Value, y=Mgmt, fill = Comp, height = ..density..)) +     geom_joy(scale = 4, stat = "density", alpha = 0.5)  + xlab(paste(i)) +  ggtitle(paste0(i, " for All Horizons")) +
scale_y_discrete(expand=c(0.1, 0)) +
scale_x_continuous(expand=c(0.01, 0)) + theme_joy() +
scale_fill_gradientn(colours = cet_pal(5, name = "fire"))
ggplot(Wd%>% filter(Prop == i ), aes(x=Value, y=Mgmt, fill = Comp, height = ..density..)) +     geom_joy(scale = 4, stat = "density", alpha = 0.5)  + xlab(paste(i)) +  ggtitle(paste0(i, " for All Horizons")) +
scale_y_discrete(expand=c(0.1, 0)) +
scale_x_continuous(expand=c(0.01, 0)) + theme_joy()
ggplot(Wd%>% filter(Prop == i ), aes(x=Value, y=Mgmt, fill = Comp, height = ..density..)) +     geom_joy(scale = 1, stat = "density", alpha = 0.5)  + xlab(paste(i)) +  ggtitle(paste0(i, " for All Horizons")) +
scale_y_discrete(expand=c(0.1, 0)) +
scale_x_continuous(expand=c(0.01, 0)) + theme_joy()
ggplot(Wd%>% filter(Prop == i ), aes(x=Value, y=Mgmt, fill = Comp, height = ..density..)) +     geom_joy(scale = 10, stat = "density", alpha = 0.5)  + xlab(paste(i)) +  ggtitle(paste0(i, " for All Horizons")) +
scale_y_discrete(expand=c(0.1, 0)) +
scale_x_continuous(expand=c(0.01, 0)) + theme_joy()
Wd%>% filter(Prop == i )%>%
ggplot(aes(x=Vaue, y = SET, color = BD)) +
geom_quasirandom(alpha=0.82, groupOnX=FALSE) +
scale_color_gradientn(colours = cet_pal(10, name = "cyclic_mrybm_35-75_c68_n256"), name = "BD") +
theme_joy() +
theme(plot.caption=element_text(hjust=0,size=9),
axis.title=element_text(size=12),
plot.title=element_text(size=24))+
labs(x="Bulk Density",y="Dataset",caption="@wills_skye", title="Beeswarm Plot of BD by Cover")
names(Wd)
Wd%>% filter(Prop == i )%>%
ggplot(aes(x=Va;ue, y = Comp, color = Value)) +
geom_quasirandom(alpha=0.82, groupOnX=FALSE) +
scale_color_gradientn(colours = cet_pal(10, name = "cyclic_mrybm_35-75_c68_n256"), name = "BD") +
theme_joy() +
theme(plot.caption=element_text(hjust=0,size=9),
axis.title=element_text(size=12),
plot.title=element_text(size=24))+
labs(x="Bulk Density",y="Dataset",caption="@wills_skye", title="Beeswarm Plot of BD by Cover")
?cet_pal
?geom_quasirandom
Wd%>% filter(Prop == i )%>%
ggplot(aes(x=Va;ue, y = Comp, color = Value)) +
geom_quasirandom(alpha=0.82, groupOnX=NULL) +
scale_color_gradientn(colours = cet_pal(10, name = "fire"), name = "BD") +
theme_joy() +
theme(plot.caption=element_text(hjust=0,size=9),
axis.title=element_text(size=12),
plot.title=element_text(size=24))+
labs(x="Bulk Density",y="Dataset",caption="@wills_skye", title="Beeswarm Plot of BD by Cover")
Wd%>% filter(Prop == i )%>%
ggplot(aes(x=Va;ue, y = Comp, color = Value)) +
geom_quasirandom(alpha=0.82, groupOnX=NULL) +
scale_color_gradientn(colours = cet_pal(10, name = "fire"), name = "BD") +
theme_joy() +
theme(plot.caption=element_text(hjust=0,size=9),
axis.title=element_text(size=12),
plot.title=element_text(size=24))+
labs(x="Bulk Density",y="Dataset",caption="@wills_skye", title="Beeswarm Plot of BD by Cover")
?scale_color_gradientn
Wd%>% filter(Prop == i )%>%
ggplot(aes(x=Va;ue, y = Comp, color = Value)) +
geom_quasirandom(alpha=0.82, groupOnX=NULL) +
scale_color_gradientn(colors = cet_pal(10, name = "fire"), name = "BD") +
theme_joy() +
theme(plot.caption=element_text(hjust=0,size=9),
axis.title=element_text(size=12),
plot.title=element_text(size=24))+
labs(x="Bulk Density",y="Dataset",caption="@wills_skye", title="Beeswarm Plot of BD by Cover")
Wd%>% filter(Prop == i )%>%
ggplot(aes(x=Va;ue, y = Comp, color = Value)) +
geom_quasirandom() +
scale_color_gradientn(colors = cet_pal(10, name = "fire"), name = "BD") +
theme_joy() +
theme(plot.caption=element_text(hjust=0,size=9),
axis.title=element_text(size=12),
plot.title=element_text(size=24))+
labs(x="Bulk Density",y="Dataset",caption="@wills_skye", title="Beeswarm Plot of BD by Cover")
Wd%>% filter(Prop == i )%>%
ggplot(aes(x=Value, y = Comp, color = Value)) +
geom_quasirandom(alpha=0.82, groupOnX=FALSE) +
scale_color_gradientn(colors = cet_pal(10, name = "fire"), name = "BD") +
theme_joy() +
theme(plot.caption=element_text(hjust=0,size=9),
axis.title=element_text(size=12),
plot.title=element_text(size=24))+
labs(x="Bulk Density",y="Dataset",caption="@wills_skye", title="Beeswarm Plot of BD by Cover")
Wd%>% filter(Prop == i )%>%
ggplot(aes(x=Value, y = Comp, color = Value)) +
geom_quasirandom(alpha=0.82, groupOnX=FALSE) +
scale_color_gradientn(colors = cet_pal(10, name = "fire"), name = "BD") +
theme_joy() +
theme(plot.caption=element_text(hjust=0,size=12),
axis.title=element_text(size=12),
plot.title=element_text(size=24))+
labs(x="Bulk Density",y="",caption="@wills_skye", title="Beeswarm Plot of BD by Cover")
lev <- as.factor(Wd$Prop)
#pdf(file = 'explore_plots.pdf')
for(i in unique(lev)){
print(i)
b <- ggplot(Wd %>% filter(Prop == i) , aes(y = Value, x = Comp)) +
geom_boxplot(aes(fill = Comp), alpha = .5) +
theme(legend.position="top")
+  ylab(paste(i)) + xlab(" ") +
ggtitle(paste0(i, for all Samples))
for(i in unique(lev)){
print(i)}
b <- ggplot(Wd %>% filter(Prop == i) , aes(y = Value, x = Comp)) +
geom_boxplot(aes(fill = Comp), alpha = .5) +
theme(legend.position="top")
+  ylab(paste(i)) + xlab(" ") +
ggtitle(paste0(i, for all Samples))
b <- ggplot(Wd %>% filter(Prop == i) , aes(y = Value, x = Comp)) +
geom_boxplot(aes(fill = Comp), alpha = .5) +
theme(legend.position="top")  +  ylab(paste(i)) + xlab(" ") +
ggtitle(paste0(i, for all Samples))
b <- ggplot(Wd %>% filter(Prop == i) , aes(y = Value, x = Comp)) +
geom_boxplot(aes(fill = Comp), alpha = .5) +
theme(legend.position="top")  +  ylab(paste(i)) + xlab(" ") +
ggtitle(paste0(i, "for all Samples"))
print(b)
print(b)
print(i)
b <- ggplot(Wd %>% filter(Prop == i) , aes(y = Value, x = Comp)) +
geom_boxplot(aes(fill = Comp), alpha = .5) +
theme(legend.position=null)  +  ylab(paste(i)) + xlab(" ") +
ggtitle(paste0(i, " for all Samples"))
?legend.position
print(i)
b <- ggplot(Wd %>% filter(Prop == i) , aes(y = Value, x = Comp)) +
geom_boxplot(aes(fill = Comp), alpha = .5) +
theme(legend.position="none")  +  ylab(paste(i)) + xlab(" ") +
ggtitle(paste0(i, " for all Samples"))
print(b)
j <- Wd%>% filter(Prop == i )%>%
ggplot(aes(x=Value, y = Comp, color = Value)) +
geom_quasirandom(alpha=0.82, groupOnX=FALSE) +
scale_color_gradientn(colors = cet_pal(10, name = "fire"), name = "BD") +
theme_joy() +
theme(plot.caption=element_text(hjust=0,size=12),
axis.title=element_text(size=12),
plot.title=element_text(size=24))+
labs(x="Bulk Density",y="",caption="@wills_skye", title="Beeswarm Plot of BD by Cover")
print(j)
b <- ggplot(Wd %>% filter(Prop == i) , aes(y = Value, x = Comp)) +
j
for(i in unique(lev)){
print(i)
b <- ggplot(Wd %>% filter(Prop == i) , aes(y = Value, x = Comp)) +
geom_boxplot(aes(fill = Comp), alpha = .5) +
theme(legend.position="none")  +  ylab(paste(i)) + xlab(" ") +
ggtitle(paste0(i, " for all Samples"))
print(b)
j <- Wd%>% filter(Prop == i )%>%
ggplot(aes(x=Value, y = Comp, color = Value)) +
geom_quasirandom(alpha=0.82, groupOnX=FALSE) +
scale_color_gradientn(colors = cet_pal(10, name = "fire"), name = "BD") +
theme_joy() +
theme(plot.caption=element_text(hjust=0,size=12),
axis.title=element_text(size=12),
plot.title=element_text(size=24))+
labs(x= i ,y="",caption="@wills_skye", title="Beeswarm Plot of BD by Cover")
print(j)
}
j <- Wd%>% filter(Prop == i )%>%
ggplot(aes(x=Value, y = Comp, color = Value)) +
geom_quasirandom(alpha=0.82, groupOnX=FALSE, size = 10) +
scale_color_gradientn(colors = cet_pal(10, name = "fire"), name = "BD") +
theme_joy() +
theme(plot.caption=element_text(hjust=0,size=10),
axis.title=element_text(size=12),
plot.title=element_text(size=24))+
labs(x= i ,y="",caption="@wills_skye")
print(j)
j
j <- Wd%>% filter(Prop == i )%>%
ggplot(aes(x=Value, y = Comp, color = hor_top)) +
geom_quasirandom(alpha=0.82, groupOnX=FALSE, size = 10) +
scale_color_gradientn(colors = cet_pal(10, name = "fire"), name = "Top") +
theme_joy() +
theme(plot.caption=element_text(hjust=0,size=10),
axis.title=element_text(size=12),
plot.title=element_text(size=24))+
labs(x= i ,y="",caption="@wills_skye")
print(j)
print(j)
table(Wd$hor_top)
j <- Wd%>% filter(Prop == i )%>%
ggplot(aes(x=Value, y = Comp, color = hor_top)) +
geom_quasirandom(alpha=0.82, groupOnX=FALSE, size = 10) +
scale_color_gradientn(colors = cet_pal(3, name = "fire"), name = "Top") +
theme_joy() +
theme(plot.caption=element_text(hjust=0,size=10),
axis.title=element_text(size=12),
plot.title=element_text(size=24))+
labs(x= i ,y="",caption="@wills_skye")
print(j)
print(j)
j <- Wd%>% filter(Prop == i )%>%
ggplot(aes(x=Value, y = Comp, color = hor_top)) +
geom_quasirandom(alpha=0.82, groupOnX=FALSE, size = 10) +
theme_joy() +
theme(plot.caption=element_text(hjust=0,size=10),
axis.title=element_text(size=12),
plot.title=element_text(size=24))+
labs(x= i ,y="",caption="@wills_skye")
print(j)
print(j)
j <- Wd%>% filter(Prop == i )%>%
ggplot(aes(x=Value, y = Comp, color = hor_top)) +
geom_quasirandom(alpha=0.82, groupOnX=FALSE, size = 10) +
theme_joy() +
scale_color_gradient(names = "Top") +
theme(plot.caption=element_text(hjust=0,size=10),
axis.title=element_text(size=12),
plot.title=element_text(size=24))+
labs(x= i ,y="",caption="@wills_skye")
j <- Wd%>% filter(Prop == i )%>%
ggplot(aes(x=Value, y = Comp, color = hor_top)) +
geom_quasirandom(alpha=0.82, groupOnX=FALSE, size = 10) +
theme_joy() +
scale_color_gradient(name = "Top") +
theme(plot.caption=element_text(hjust=0,size=10),
axis.title=element_text(size=12),
plot.title=element_text(size=24))+
labs(x= i ,y="",caption="@wills_skye")
print(j)
print(j)
table(Wd$hor_bot)
table(Wd$hor_top)
?weighted.mean
Comp.SOIL <- as.data.frame(Wd %>%
filter(Prop %in% Properties) %>%
select(Comp, Soil, Prop, Value) %>%
mutate(thick = hor_bot - hor_top) %>%
group_by(Comp, Soil, Prop)%>%
summarise(N= sum(!is.na(Value)),
mean = weighted.mean(x= Value, w = thick na.rm=TRUE),
Comp.SOIL <- as.data.frame(Wd %>%
filter(Prop %in% Properties) %>%
select(Comp, Soil, Prop, Value) %>%
mutate(thick = hor_bot - hor_top) %>%
group_by(Comp, Soil, Prop)%>%
summarise(N= sum(!is.na(Value)),
mean = weighted.mean(x= Value, w = thick, na.rm=TRUE),
min = min(Value, na.rm=T),
max = max(Value, na.rm=T)))
Comp.SOIL <- as.data.frame(Wd %>%
filter(Prop %in% Properties) %>%
select(Comp, Soil, Prop, Value, hor_top, hor_bot) %>%
mutate(thick = hor_bot - hor_top) %>%
group_by(Comp, Soil, Prop)%>%
summarise(N= sum(!is.na(Value)),
mean = weighted.mean(x= Value, w = thick, na.rm=TRUE),
min = min(Value, na.rm=T),
max = max(Value, na.rm=T)))
View(Comp.SOIL)
Properties <- c('WaterSol_P', 'Mehlich3_P', 'Tot_P', 'NewZ_P', 'AggStab', 'Bgluc',  'Pom_C', 'CALC_SOC', 'Tot_N', 'Pom_N','BulkDensity', 'ph_h20', 'CEC_ph7')
Comp.SOIL <- as.data.frame(Wd %>%
filter(Prop %in% Properties) %>%
select(Comp, Soil, Prop, Value, hor_top, hor_bot) %>%
mutate(thick = hor_bot - hor_top) %>%
group_by(Comp, Soil, Prop)%>%
summarise(N= sum(!is.na(Value)),
mean = weighted.mean(x= Value, w = thick, na.rm=TRUE),
min = min(Value, na.rm=T),
max = max(Value, na.rm=T)))
View(Comp.SOIL)
Rout
write_csv(Comp.SOIL, file.path(Rout))
write_csv(Comp.SOIL, file.path(Rout, "Comp_soil.csv"))
Properties <- c('WaterSol_P', 'Mehlich3_P', 'Tot_P', 'NewZ_P', 'AggStab', 'Bgluc',  'Pom_C', 'CALC_SOC', 'Tot_N', 'Pom_N','BulkDensity', 'ph_h20', 'CEC_ph7')
Comp.SOIL <- as.data.frame(Wd %>%
filter(Prop %in% Properties) %>%
select(Comp, Soil, Prop, Value, hor_top, hor_bot) %>%
mutate(thick = hor_bot - hor_top) %>%
group_by(Comp, Soil, Prop)%>%
summarise(N= sum(!is.na(Value)),
wt.mean = weighted.mean(x= Value, w = thick, na.rm=TRUE),
min = min(Value, na.rm=T),
max = max(Value, na.rm=T)))
Comp <- as.data.frame(Wd %>%
filter(Prop %in% Properties) %>%
select(Comp, Soil, Prop, Value, hor_top, hor_bot) %>%
mutate(thick = hor_bot - hor_top) %>%
group_by(Comp, Prop)%>%
summarise(N= sum(!is.na(Value)),
w.mean = weighted.mean(x= Value, w = thick na.rm=TRUE),
Properties <- c('WaterSol_P', 'Mehlich3_P', 'Tot_P', 'NewZ_P', 'AggStab', 'Bgluc',  'Pom_C', 'CALC_SOC', 'Tot_N', 'Pom_N','BulkDensity', 'ph_h20', 'CEC_ph7')
Comp.SOIL <- as.data.frame(Wd %>%
filter(Prop %in% Properties) %>%
select(Comp, Soil, Prop, Value, hor_top, hor_bot) %>%
mutate(thick = hor_bot - hor_top) %>%
group_by(Comp, Soil, Prop)%>%
summarise(N= sum(!is.na(Value)),
wt.mean = weighted.mean(x= Value, w = thick, na.rm=TRUE),
min = min(Value, na.rm=T),
max = max(Value, na.rm=T)))
Comp <- as.data.frame(Wd %>%
filter(Prop %in% Properties) %>%
select(Comp, Soil, Prop, Value, hor_top, hor_bot) %>%
mutate(thick = hor_bot - hor_top) %>%
group_by(Comp, Prop)%>%
summarise(N= sum(!is.na(Value)),
w.mean = weighted.mean(x= Value, w = thick, na.rm=TRUE),
min = min(Value, na.rm=T),
max = max(Value, na.rm=T)))
Comp.SOIL.surf <- as.data.frame(Wd %>%
filter(Prop %in% Properties & hor_top ==0) %>%
select(Comp, Soil, Prop, Value, hor_top, hor_bot) %>%
mutate(thick = hor_bot - hor_top) %>%
group_by(Comp, Soil, Prop)%>%
summarise(N= sum(!is.na(Value)),
wt.mean = weighted.mean(x= Value, w = thick, na.rm=TRUE),
min = min(Value, na.rm=T),
max = max(Value, na.rm=T)))
Comp.surf <- as.data.frame(Wd %>%
filter(Prop %in% Properties& hor_top ==0) %>%
select(Comp, Soil, Prop, Value, hor_top, hor_bot) %>%
mutate(thick = hor_bot - hor_top) %>%
group_by(Comp, Prop)%>%
summarise(N= sum(!is.na(Value)),
w.mean = weighted.mean(x= Value, w = thick, na.rm=TRUE),
min = min(Value, na.rm=T),
max = max(Value, na.rm=T)))
write_csv(Comp.SOIL, file.path(Rout, "Comp_soil.csv"))
write_csv(Comp, file.path(Rout, "Comp.csv"))
write_csv(Comp.SOIL.surf, file.path(Rout, "Comp_soil_surf.csv"))
write_csv(Comp.surf, file.path(Rout, "Comp_surf.csv"))
Msurf <- Wd %>%
filter(Prop %in% Properties & hor_top == 0)
surf.n <- Msurf %>%
group_by(Prop)%>%
nest()
#function for glm model
fit_mod <- function(data){
mod <- lm(Value ~ Comp, random=~1|Comp, data = data)
return(anova(mod))
}
fit_mod(surf.n$data[[1]])
# #
surf.n <- surf.n %>%
mutate(mod = purrr::map(data, fit_mod))
# #
#surf.n$mod[[1]]
# #
#   broom::glance(surf.n$mod[[1]])
#   broom::tidy(surf.n$mod[[1]])
surf.n <- surf.n %>%
dplyr::mutate(tidy = purrr::map(mod, broom::tidy),
n = purrr::map(data, nrow) %>% simplify())
surf.n
surf.m <- surf.n %>%
tidyr::unnest(tidy)
surf.m
surf.m
write_csv(surf.m, file.path(Rout,"Test.surface.csv"))
