"0","Properties <- c('WaterSol_P', 'Mehlich3_P', 'Tot_P', 'NewZ_P', 'AggStab', 'Bgluc',  'Pom_C', 'CALC_SOC', 'Tot_N', 'Pom_N','BulkDensity', 'pH_H20', 'CEC_ph7')"
"0","Msurf <- Wd %>% "
"0","  filter(Prop %in% Properties & hor_top == 0)"
"0","surf.n <- Msurf %>%"
"0","   group_by(Prop)%>%"
"0","  nest()"
"0","#function for glm model "
"0","fit_mod <- function(data){"
"0","    mod <- lm(Value ~ Comp * Soil, data = data)"
"0","    return(anova(mod))"
"0","  }"
"0","#check that output is appropriate"
"0","# "
"0"," fit_mod(surf.n$data[[1]])"
"1","Analysis of Variance Table
"
"1","
"
"1","Response: Value"
"1","
"
"1","         "
"1"," Df"
"1"," Sum Sq"
"1"," Mean Sq"
"1"," F value"
"1","    Pr(>F)"
"1","    "
"1","
Comp     "
"1","  1"
"1","  57.04"
"1","   57.04"
"1","   6.338"
"1"," 0.0399545"
"1"," *  "
"1","
Soil     "
"1","  2"
"1"," 690.62"
"1","  345.31"
"1","  38.368"
"1"," 0.0001689"
"1"," ***"
"1","
Comp:Soil"
"1","  1"
"1","  98.00"
"1","   98.00"
"1","  10.889"
"1"," 0.0131238"
"1"," *  "
"1","
Residuals"
"1","  7"
"1","  63.00"
"1","    9.00"
"1","        "
"1","          "
"1","    "
"1","
"
"1","---
Signif. codes:  "
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"0","# #"
"0"," surf.n <- surf.n %>%"
"0","   mutate(mod = purrr::map(data, fit_mod))"
"0","# #"
"0","#surf.n$mod[[1]]"
"0","# #"
"0","#   broom::glance(surf.n$mod[[1]])"
"0","#   broom::tidy(surf.n$mod[[1]])"
"0","  "
"0","surf.n <- surf.n %>%"
"0","                 dplyr::mutate(tidy = purrr::map(mod, broom::tidy),"
"0","                               n = purrr::map(data, nrow) %>% simplify())"
"0","surf.n"
